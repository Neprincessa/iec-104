python3 scripts/setup-app-layer.py --detect --logger --parser s7 common

дальше по инструкции.
после того, как проект собран, идем в app-layer-s7.c и меняем дефольный порт

после этого меняем конфигурационный файл таким образом, чтобы отключить все протоколы и оставить только наш.
В итоге будет файлик suricata.yyaml, который лежит рядом
