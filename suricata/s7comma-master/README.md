# s7comma
тип каламбур

## Полезные ссылки
Wireshark s7comm - https://wiki.wireshark.org/S7comm
Google doca - https://docs.google.com/document/d/1XbCD6MBYrLuF6lm5KpZvPp0o7jSkRx-kL3_DBqzCADg/edit?usp=sharing
Симмулятор - https://labs.p64cyber.com/pentesting-ics-s7comm/
Дока к нему - https://python-snap7.readthedocs.io

## Структура пакета:
Идентификатор протокола: [1b] константа протокола всегда имеет значение 0x32;  
Тип сообщения: [1b] общий тип сообщения  
0x01-Job Request : запрос, отправленный клиентом (например, чтение / запись памяти, чтение/запись блоков, запуск / остановка устройства, настройка связи);  
0x02-Ack : простое подтверждение без поля данных;  
0x03-Ack-Data: подтверждение с дополнительным полем данных, содержит ответ на Job Request;  
0x07-Userdata: расширение исходного протокола, поле параметра содержит идентификатор запроса / ответа, (используется для программирования/отладки, считывания SZL, функций безопасности, настройки времени, циклического считывания..)  
Reserved/Зарезервировано: [2b] всегда устанавливается значение 0x0000 (но, вероятно, игнорируется)  
PDU reference: [2b] генерируется клиентом, увеличивается с каждой новой передачей, используется для связывания ответов на их запросы, Little-Endian (Примечание: это поведение WinCC, Step7 и других программ Siemens, вероятно, оно может быть случайно сгенерировано, PLC просто копирует его в ответ)  
Длина параметра: [2b] длина поля параметра, Big-Endian  
Длина данных: [2b] длина поля данных, Big-Endian  
(Класс ошибок): [1b] только присутствует в сообщениях Ack-Data;  
(Код ошибки): [1b] только присутствует в сообщениях Ack-Data.  
  


## Логика парсинга
1) С помощью регулярки понять, что это протокол s7comm и вытащить из него длинну параметров и данных
2) по длинне вытащить параметр определить тип пакета
3) по длинне вытащить данные.
нужно ли Message Type?
если несколько перемнных на read var, то как они делятся и как длинна пишется?
при ask data нужно добавлять еще два два байта в конце хедеров?
